# è¶³çƒæ¯”èµ›é¢„æµ‹AIç³»ç»Ÿ

åŸºäº **Llama 3.2 1B** çš„è¶³çƒæ¯”èµ›é¢„æµ‹ç³»ç»Ÿï¼Œé€šè¿‡åˆ†æèµ”ç‡ã€å†å²æˆ˜ç»©ã€è”èµ›æ’åç­‰å¤šç»´æ•°æ®é¢„æµ‹æ¯”èµ›ç»“æœã€‚è¯¥ç³»ç»Ÿé‡‡ç”¨å…ˆè¿›çš„å¤§å‹è¯­è¨€æ¨¡å‹å¾®è°ƒæŠ€æœ¯ï¼Œç»“åˆé‡åŒ–å’Œå‚æ•°é«˜æ•ˆå¾®è°ƒï¼ˆPEFTï¼‰æ–¹æ³•ï¼Œä½¿æ¨¡å‹èƒ½åœ¨æ™®é€šç¡¬ä»¶ä¸Šè¿è¡Œå’Œå¾®è°ƒã€‚

## ğŸš€ é¡¹ç›®åŠŸèƒ½

- **æ•°æ®å¤„ç†æ¨¡å—**ï¼šæ”¯æŒå¤šç§æ ¼å¼çš„è¶³çƒæ¯”èµ›æ•°æ®å¯¼å…¥ã€æ¸…æ´—å’Œç‰¹å¾å·¥ç¨‹
- **æ¨¡å‹è®­ç»ƒæ¨¡å—**ï¼šåŸºäº Llama 3.2 1B çš„é«˜æ•ˆå¾®è°ƒï¼Œæ”¯æŒé‡åŒ–å’ŒLoRAæŠ€æœ¯
- **é¢„æµ‹æ¨ç†æ¨¡å—**ï¼šæä¾›å¤šç§é¢„æµ‹æ¥å£ï¼ˆå‘½ä»¤è¡Œã€æ‰¹å¤„ç†ã€äº¤äº’å¼ï¼‰
- **æ™ºèƒ½åˆ†æ**ï¼šç”Ÿæˆæ¯”èµ›ç»“æœé¢„æµ‹å’Œè¯¦ç»†åˆ†æç†ç”±

## ğŸ›  æŠ€æœ¯æ ˆ

- **Python 3.9+**ï¼šæ ¸å¿ƒå¼€å‘è¯­è¨€
- **PyTorch**ï¼šæ·±åº¦å­¦ä¹ æ¡†æ¶
- **Transformers (Hugging Face)**ï¼šæä¾›é¢„è®­ç»ƒæ¨¡å‹å’Œè®­ç»ƒå·¥å…·
- **PEFT**ï¼šå‚æ•°é«˜æ•ˆå¾®è°ƒæŠ€æœ¯ï¼Œå‡å°‘è®¡ç®—èµ„æºéœ€æ±‚
- **BitsAndBytes**ï¼šæ¨¡å‹é‡åŒ–ï¼Œé™ä½å†…å­˜å ç”¨
- **Pandas/NumPy/Scikit-learn**ï¼šæ•°æ®å¤„ç†å’Œç§‘å­¦è®¡ç®—
- **YAML/OmegaConf**ï¼šé…ç½®ç®¡ç†
- **Loguru**ï¼šé«˜çº§æ—¥å¿—ç®¡ç†

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ data/                       # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                    # åŸå§‹æ•°æ®
â”‚   â””â”€â”€ processed/              # é¢„å¤„ç†åçš„æ•°æ®
â”œâ”€â”€ models/                     # æ¨¡å‹å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ fine_tuned_model/       # å¾®è°ƒåçš„æ¨¡å‹
â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•°åº“
â”‚   â”œâ”€â”€ data_processor.py       # æ•°æ®å¤„ç†ç±»å’Œå‡½æ•°
â”‚   â”œâ”€â”€ model_utils.py          # æ¨¡å‹åŠ è½½å’Œé…ç½®å‡½æ•°
â”‚   â””â”€â”€ prediction_utils.py     # é¢„æµ‹ç›¸å…³å·¥å…·å‡½æ•°
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config.yaml             # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ examples/                   # ç¤ºä¾‹æ–‡ä»¶
â”‚   â”œâ”€â”€ sample_input.json       # é¢„æµ‹è¾“å…¥ç¤ºä¾‹
â”‚   â””â”€â”€ sample_training_data.json # è®­ç»ƒæ•°æ®ç¤ºä¾‹
â”œâ”€â”€ preprocess.py               # æ•°æ®é¢„å¤„ç†ä¸»è„šæœ¬
â”œâ”€â”€ train.py                    # æ¨¡å‹è®­ç»ƒä¸»è„šæœ¬
â”œâ”€â”€ predict.py                  # åŸºç¡€é¢„æµ‹è„šæœ¬
â”œâ”€â”€ predict_interface.py        # å¢å¼ºé¢„æµ‹æ¥å£ï¼ˆäº¤äº’å¼/æ‰¹é‡ï¼‰
â”œâ”€â”€ test_training.py            # è®­ç»ƒæµç¨‹æµ‹è¯•è„šæœ¬
â””â”€â”€ requirements.txt            # é¡¹ç›®ä¾èµ–
```

## ğŸ“‹ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿å®‰è£…äº†Python 3.9æˆ–æ›´é«˜ç‰ˆæœ¬ï¼š

```bash
python3 --version
```

### 2. å®‰è£…ä¾èµ–

```bash
python3 -m pip install -r requirements.txt
```

### 3. æ•°æ®å‡†å¤‡

#### è®­ç»ƒæ•°æ®æ ¼å¼

è®­ç»ƒæ•°æ®å¯ä»¥æ˜¯CSVæˆ–JSONæ ¼å¼ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š

- **åŸºæœ¬ä¿¡æ¯**ï¼šä¸»é˜Ÿåã€å®¢é˜Ÿåã€è”èµ›ã€æ¯”èµ›æ—¥æœŸ
- **èµ”ç‡ä¿¡æ¯**ï¼šä¸»èƒœèµ”ç‡ã€å¹³å±€èµ”ç‡ã€å®¢èƒœèµ”ç‡
- **æ’åä¿¡æ¯**ï¼šä¸»é˜Ÿæ’åã€å®¢é˜Ÿæ’å
- **è¿‘æœŸè¡¨ç°**ï¼šæœ€è¿‘5åœºæ¯”èµ›ç»“æœï¼ˆW=èƒœï¼ŒD=å¹³ï¼ŒL=è´Ÿï¼‰
- **å†å²äº¤é”‹**ï¼šå†å²äº¤é”‹è®°å½•ï¼ˆH=ä¸»é˜Ÿèƒœï¼ŒD=å¹³ï¼ŒA=å®¢é˜Ÿèƒœï¼‰
- **è¿›æ”»é˜²å®ˆ**ï¼šè¿›çƒæ•°ã€å¤±çƒæ•°
- **ç»“æœæ ‡ç­¾**ï¼šå®é™…æ¯”èµ›ç»“æœï¼ˆhome_win/draw/away_winï¼‰

#### é¢„æµ‹æ•°æ®æ ¼å¼

ä¸è®­ç»ƒæ•°æ®ç±»ä¼¼ï¼Œä½†ä¸éœ€è¦ç»“æœæ ‡ç­¾ã€‚

### 4. æ•°æ®é¢„å¤„ç†

å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºæ¨¡å‹å¯ç”¨çš„æ ¼å¼ï¼š

```bash
python3 preprocess.py \
    --input_file data/raw/matches.csv \
    --output_dir data/processed \
    --split_ratio 0.8 0.1 0.1
```

### 5. æ¨¡å‹è®­ç»ƒ

ä½¿ç”¨é…ç½®æ–‡ä»¶è¿›è¡Œè®­ç»ƒï¼š

```bash
python3 train.py --config config/config.yaml
```

æˆ–è€…ç›´æ¥æŒ‡å®šå‚æ•°ï¼š

```bash
python3 train.py \
    --base_model meta-llama/Llama-3.2-1B \
    --train_data data/processed/train.json \
    --valid_data data/processed/valid.json \
    --output_dir models/fine_tuned_model \
    --num_epochs 3 \
    --batch_size 4 \
    --learning_rate 5e-5 \
    --quantization
```

### 6. é¢„æµ‹ä½¿ç”¨

#### åŸºç¡€é¢„æµ‹

```bash
python3 predict.py \
    --model_path models/fine_tuned_model \
    --input_file examples/sample_input.json \
    --output_file prediction_result.json
```

#### äº¤äº’å¼é¢„æµ‹

```bash
python3 predict_interface.py --mode interactive
```

#### æ‰¹é‡é¢„æµ‹

```bash
python3 predict_interface.py \
    --mode batch \
    --input_file examples/batch_inputs.json \
    --output_file batch_predictions.json
```

## âš™ï¸ é…ç½®è¯¦è§£

ä¸»è¦é…ç½®æ–‡ä»¶ `config/config.yaml` åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š

### æ¨¡å‹é…ç½®
```yaml
model:
  base_model: "meta-llama/Llama-3.2-1B"  # åŸºç¡€æ¨¡å‹
  quantization: true                    # æ˜¯å¦ä½¿ç”¨é‡åŒ–
  device_map: "auto"                    # è®¾å¤‡åˆ†é…
```

### è®­ç»ƒé…ç½®
```yaml
training:
  num_epochs: 3                         # è®­ç»ƒè½®æ•°
  batch_size: 4                         # æ‰¹é‡å¤§å°
  learning_rate: 5e-5                   # å­¦ä¹ ç‡
  gradient_accumulation_steps: 2        # æ¢¯åº¦ç´¯ç§¯æ­¥æ•°
  max_seq_length: 1024                  # æœ€å¤§åºåˆ—é•¿åº¦
```

### æ•°æ®é…ç½®
```yaml
data:
  train_file: "data/processed/train.json"  # è®­ç»ƒæ•°æ®
  valid_file: "data/processed/valid.json"  # éªŒè¯æ•°æ®
  test_file: "data/processed/test.json"    # æµ‹è¯•æ•°æ®
```

### PEFTé…ç½®
```yaml
peft:
  use_peft: true                        # æ˜¯å¦ä½¿ç”¨PEFT
  lora_r: 8                             # LoRAç§©
  lora_alpha: 32                        # LoRA alphaå‚æ•°
  lora_dropout: 0.1                     # LoRA dropout
```

## ğŸ“Š æ¨¡å‹æ€§èƒ½è¯„ä¼°

è®­ç»ƒå®Œæˆåï¼Œæ¨¡å‹ä¼šè‡ªåŠ¨åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°ï¼Œå¹¶ç”Ÿæˆä»¥ä¸‹æŒ‡æ ‡ï¼š

- **å‡†ç¡®ç‡**ï¼šé¢„æµ‹æ­£ç¡®çš„æ¯”èµ›æ¯”ä¾‹
- **F1åˆ†æ•°**ï¼šç»¼åˆç²¾ç¡®ç‡å’Œå¬å›ç‡çš„æŒ‡æ ‡
- **æ··æ·†çŸ©é˜µ**ï¼šå±•ç¤ºå„ç±»åˆ«çš„é¢„æµ‹æƒ…å†µ
- **ROCæ›²çº¿**ï¼šå±•ç¤ºåˆ†ç±»å™¨çš„æ€§èƒ½

## ğŸš¦ å¸¸è§é—®é¢˜

### å†…å­˜ä¸è¶³é”™è¯¯
- ä½¿ç”¨ `--quantization` å‚æ•°å¯ç”¨æ¨¡å‹é‡åŒ–
- å‡å° `batch_size` å’Œ `gradient_accumulation_steps`
- ä½¿ç”¨æ›´å°çš„ `max_seq_length`

### è®­ç»ƒé€Ÿåº¦æ…¢
- å¯ç”¨æ¢¯åº¦ç´¯ç§¯
- æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†GPUåŠ é€Ÿ
- è€ƒè™‘ä½¿ç”¨æ›´é«˜æ•ˆçš„PEFTé…ç½®

### é¢„æµ‹è´¨é‡ä¸ä½³
- å¢åŠ è®­ç»ƒæ•°æ®é‡å’Œå¤šæ ·æ€§
- è°ƒæ•´å­¦ä¹ ç‡å’Œè®­ç»ƒè½®æ•°
- ä¼˜åŒ–æ•°æ®é¢„å¤„ç†å’Œç‰¹å¾å·¥ç¨‹

## ğŸ“ ç¤ºä¾‹è¾“å…¥è¾“å‡º

### è¾“å…¥ç¤ºä¾‹
```json
{
  "home_team": "æ›¼è”",
  "away_team": "åˆ©ç‰©æµ¦",
  "home_odds": 3.25,
  "draw_odds": 3.50,
  "away_odds": 2.10,
  "home_ranking": 5,
  "away_ranking": 1,
  "league": "è‹±è¶…è”èµ›",
  "home_recent_results": ["W", "D", "W", "L", "W"],
  "away_recent_results": ["W", "W", "W", "W", "D"],
  "head_to_head": ["D", "L", "A", "D", "H"]
}
```

### è¾“å‡ºç¤ºä¾‹
```json
{
  "prediction": "L",
  "confidence": 0.72,
  "detailed_probabilities": {
    "home_win": 0.18,
    "draw": 0.10,
    "away_win": 0.72
  },
  "score": "1-2",
  "analysis": "æ ¹æ®å®¢é˜Ÿçš„è”èµ›æ’åï¼ˆç¬¬1ï¼‰ã€è¿‘æœŸå‡ºè‰²è¡¨ç°ï¼ˆ4èƒœ1å¹³ï¼‰å’Œè¾ƒä½çš„èµ”ç‡ï¼ˆ2.10ï¼‰ï¼Œé¢„è®¡å®¢é˜Ÿå°†è·èƒœã€‚ä¸»é˜Ÿè¿‘æœŸçŠ¶æ€ä¸ç¨³å®šï¼Œä¸”å†å²äº¤é”‹å¤„äºåŠ£åŠ¿ã€‚",
  "home_team": "æ›¼è”",
  "away_team": "åˆ©ç‰©æµ¦",
  "league": "è‹±è¶…è”èµ›"
}

## ğŸ§ª å¼€å‘å’Œæµ‹è¯•

### æµ‹è¯•è®­ç»ƒæµç¨‹

ä½¿ç”¨ç®€åŒ–çš„æµ‹è¯•è„šæœ¬éªŒè¯è®­ç»ƒç¯å¢ƒï¼š

```bash
python3 test_training.py
```

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨ `utils/` ç›®å½•ä¸‹æ·»åŠ æ–°çš„å·¥å…·å‡½æ•°
2. æ›´æ–°ä¸»è„šæœ¬ä»¥è°ƒç”¨æ–°åŠŸèƒ½
3. æ›´æ–°é…ç½®æ–‡ä»¶ä»¥æ”¯æŒæ–°å‚æ•°
4. ç¼–å†™é€‚å½“çš„æµ‹è¯•

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤é—®é¢˜å’Œæ‹‰å–è¯·æ±‚ï¼

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·é€šè¿‡ Issues ä¸æˆ‘ä»¬è”ç³»ã€‚